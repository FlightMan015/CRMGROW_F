<div class="page-content">
  <div class="v-center op-56 c-pointer back-menu" (click)="goToBack()">
    <i class="d-block i-icon i-triangle-left bgc-dark mr-2"></i>
    <span class="f-5 font-weight-bold">Back {{getPrevPage()}}</span>
  </div>
  <div class="my-2">
    <div class="d-flex justify-content-between mr-5">
      <h6 class="page-title font-weight-bold my-2">Material Analytics</h6>
      <ng-container *ngIf="!isLoading && analytic_material">
        <div class="v-center mr-5">
          <button class="v-center btn p-1 c-dark mr-2" placement="bottom" (click)="sendMaterial('email')"
            ngbTooltip="Send via Email">
            <i class="i-icon i-message bgc-blue mr-1" aria-hidden="true"></i>
            <span class="f-3 font-weight-bold c-blue">Send Email</span>
          </button>
          <button class="v-center btn p-1 c-dark mr-2" placement="bottom" ngbTooltip="Send via Text"
            (click)="sendMaterial('text')">
            <i class="i-icon i-sms-sent bgc-blue mr-1" aria-hidden="true"></i>
            <span class="f-3 font-weight-bold c-blue">Send Text</span>
          </button>
          <button class="v-center btn p-1 c-dark mr-2" placement="bottom" ngbTooltip="Copy Link" (click)="copyLink()">
            <i class="i-icon i-copy bgc-blue mr-1" aria-hidden="true"></i>
            <span class="f-3 font-weight-bold c-blue">Copy Link</span>
          </button>
          <div class="v-center material-actions mr-3">
            <div ngbDropdown #mainDrop="ngbDropdown" placement="bottom-right" class="ml-auto">
              <a ngbDropdownToggle class="v-center btn bgc-white c-dark f-3 no-carot px-0">
                <i class="d-block i-icon i-menu-more bgc-dark"></i>
              </a>
              <div ngbDropdownMenu class="light">
                <ng-container *ngIf="analytic_material.user; else materialActionsTemplate">
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="editMaterial()"
                    *ngIf="analytic_material.user == user_id">
                    <i class="i-icon i-edit bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Edit</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="editTemplate()">
                    <i class="i-icon i-template bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Edit Theme</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="leadCapture()">
                    <i class="i-icon i-lead-capture bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Lead Capture</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="duplicateMaterial()">
                    <i class="i-icon i-duplicate bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Duplicate</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="shareMaterial()">
                    <i class="i-icon i-shared-by bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Social Share</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="shareTeam()"
                    *ngIf="(analytic_material.user == user_id) && analytic_material.role != 'team'">
                    <i class="i-icon i-share-team bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Share Team</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="generateTrackableLink()">
                    <i class="i-icon i-link-track bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Trackable Link</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" *ngIf="analytic_material.material_type === 'video' && checkType(analytic_material.url) &&
                      (analytic_material.user === user_id) && !analytic_material.default_edited" (click)="download()">
                    <i class="i-icon i-download bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Download</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="deleteMaterial()">
                    <i class="i-icon i-trash bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Delete</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="moveToFolder()">
                    <i class="i-icon i-folder bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Move To</span>
                  </button>
                </ng-container>
                <ng-template #materialActionsTemplate>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="editTemplate()">
                    <i class="i-icon i-template bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Edit Theme</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="leadCapture()">
                    <i class="i-icon i-lead-capture bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Lead Capture</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="duplicateMaterial()">
                    <i class="i-icon i-duplicate bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Duplicate</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="shareMaterial()">
                    <i class="i-icon i-shared-by bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Social Share</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="deleteMaterial()">
                    <i class="i-icon i-trash bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Delete</span>
                  </button>
                  <button class="v-center border-0 py-2 c-dark dropdown-item" (click)="moveToFolder()">
                    <i class="i-icon i-folder bgc-dark ml-1" aria-hidden="true"></i>
                    <span class="ml-3 f-3 font-weight-bold">Move To</span>
                  </button>
                </ng-template>
              </div>
            </div>
          </div>

        </div>
      </ng-container>
    </div>

  </div>
  <div class="v-center">

    <ng-container *ngIf="isLoading">
      <div class="list-loading text-center">
        <div class="loader mt-5 lg"></div>
        <h4 class="fw-600 mt-2">Loading analytics...</h4>
      </div>
    </ng-container>
    <ng-container *ngIf="!isLoading && analytic_material">
      <div class="analytics-area mt-3" *ngIf="analytic_material.material_type=='video';else otheranalyticTemplate">
        <div class="material-wrapper form-group">
          <a href="{{siteUrl}}/video?video={{material_id}}&user={{user_id}}" target="_blank">
            <div class="thumb-prev-wrapper">
              <img [src]="analytic_material.thumbnail" class="thumbnail"
                onerror="( this.src = './assets/img/video_thumb.jpg');" />
              <img [src]="analytic_material.preview" class="preview"
                onerror="( this.src = './assets/img/video_thumb.jpg');" />
            </div>
          </a>
          <div class="mt-3">
            <label>Title</label>
            <div class="f-3 font-weight-bold">{{analytic_material.title}}</div>
          </div>
          <div class="mt-3">
            <label>Description</label>
            <div class="f-1">{{(analytic_material.description || '') | stripTags | shorten: 120: '...'}}</div>
          </div>
          <div class="mt-3">
            <label>Type</label>
            <div class="v-center f-3 font-weight-bold">
              <i class="i-icon d-block bgc-black" [class]="'i-' + getMaterialType().toLowerCase()"></i>
              <span class="f-3 font-weight-bold ml-3">{{getMaterialType()}}</span>
            </div>
          </div>
        </div>
        <div class="analytics-wrapper ml-lg-5 ml-md-3 ml-sm-0 ml-0 mt-md-0 mt-sm-0 mt-3">
          <!-- <div class="material-track p-4 mb-5">
            <div class="f-6 font-weight-bold mb-4">
              crmgrow allows you to track:
            </div>
            <div class="track-allow-selector">
              <div class="track-item">
                <img src="../../../assets/img/onboarding/track_allow_1.svg">
                <div class="f-4 mt-2">
                  Which contacts have watched your video.
                </div>
              </div>
              <div class="track-item">
                <img src="../../../assets/img/onboarding/track_allow_2.svg">
                <div class="f-4 mt-2">
                  When and how many times  they have watched it.
                </div>
              </div>
              <div class="track-item">
                <img src="../../../assets/img/onboarding/track_allow_3.svg">
                <div class="f-4 mt-2">
                  How much of the video they watched.
                </div>
              </div>
            </div>  
          </div> -->
          <div class="range-selector">
            <div class="range-item">
              <div class="v-center justify-content-between">
                <div class="f-3 font-weight-bold c-dark">Sent</div>
                <!-- <div class="v-center">
                  <i class="i-icon arrow-icon i-triangle-left bgc-dark"></i>
                  <div class="f-1 c-range select-text font-weight-bold text-uppercase c-dark">Total</div>
                  <i class="i-icon arrow-icon i-triangle-right bgc-dark"></i>
                </div> -->
              </div>
              <div class="mt-3">
                <p class="f-40 c-blue">{{analytics.sent_activity}}</p>
              </div>
            </div>
            <div class="range-item">
              <div class="v-center justify-content-between">
                <div class="f-3 font-weight-bold c-dark">Watched</div>
                <!-- <div class="v-center">
                  <i class="i-icon arrow-icon i-triangle-left bgc-dark"></i>
                  <div class="f-1 c-range select-text font-weight-bold text-uppercase c-dark">Total</div>
                  <i class="i-icon arrow-icon i-triangle-right bgc-dark"></i>
                </div> -->
              </div>
              <div class="mt-3">
                <p class="f-40 c-blue">{{analytics.watched_activity.length}}</p>
              </div>
            </div>
            <div class="range-item">
              <div class="v-center justify-content-between">
                <div class="f-3 font-weight-bold c-dark">Unique contact</div>
                <!-- <div class="v-center">
                  <i class="i-icon arrow-icon i-triangle-left bgc-dark"></i>
                  <div class="f-1 c-range select-text font-weight-bold text-uppercase c-dark">Total</div>
                  <i class="i-icon arrow-icon i-triangle-right bgc-dark"></i>
                </div> -->
              </div>
              <div class="mt-3">
                <p class="f-40 c-blue">{{analytics.watched_contacts.length}}</p>
              </div>
            </div>
          </div>
          <div class="mt-3">
            <mat-accordion>
              <mat-expansion-panel [expanded]="topExpanded" hideToggle>
                <mat-expansion-panel-header (click)="changeExpanded()">
                  <mat-panel-title>
                    <div class="v-center justify-content-between border-0 p-2 c-dark expand w-100">
                      <div class="v-center">
                        <i class="i-icon i-triangle-right expand-icon bg-dark opacity-6 mr-3" aria-hidden="true"
                          [class.expand]="topExpanded"></i>
                        <span class="f-6 font-weight-bold">Watched last by</span>
                      </div>
                      <div class="v-center">
                        <i class="i-icon i-calendar bgc-blue ml-1" aria-hidden="true"></i>
                        <span class="ml-2 f-3 font-weight-bold c-blue text-uppercase">Total</span>
                      </div>
                    </div>
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="contacts-wrapper w-100">
                  <table class="table watched-contact-table p-2">
                    <thead>
                      <tr>
                        <th class="name">Contact Name</th>
                        <th class="label">Label</th>
                        <th class="progress-wrapper">Progress</th>
                        <th class="watched-date">Watched Date</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngIf="contacts">
                        <tr *ngFor="let contact of contacts">
                          <td class="name">
                            <div class="v-center c-pointer" (click)="toContact(contact._id)">
                              <div>
                                <img *ngIf="contact.picture_profile; else avatarNameTemplate"
                                  [src]="contact.picture_profile"
                                  onerror="( this.src = './assets/img/user_avatar.svg');"
                                  class="form-avatar rounded-circle mr-1" />
                                <ng-template #avatarNameTemplate>
                                  <div class="form-avatar rounded-circle bg-dark mr-3">{{getAvatarName(contact)}}</div>
                                </ng-template>
                              </div>
                              <div class="f-4 ml-2">
                                <div *ngIf="!contact.first_name && !contact.last_name">Unnamed Contact</div>
                                <div *ngIf="contact.first_name || contact.last_name">
                                  {{contact.first_name || ''}} {{contact.last_name || ''}}
                                </div>
                              </div>
                            </div>
                          </td>
                          <td class="label">
                            <div class="v-center">
                              <div class="label-container">
                                <div class="label-rectangle"
                                  [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                                <div class="label-circle"
                                  [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                              </div>
                              <span class="f-3 font-weight-bold ml-2">{{getLabelById(contact.label).name}}</span>
                            </div>
                          </td>
                          <td class="progress-wrapper">
                            <div class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                              {{(contact.duration / analytic_material.duration * 100).toFixed(1)}}%</div>
                          </td>
                          <td class="watched-date">
                            {{contact.updated_at | date: 'MMM dd, hh:mm a'}}
                          </td>
                        </tr>
                      </ng-container>
                  </table>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </div>
          <div class="mt-3">
            <mat-accordion>
              <mat-expansion-panel [expanded]="lowExpanded" hideToggle>
                <mat-expansion-panel-header (click)="changeTrackExpanded()">
                  <mat-panel-title>
                    <div class="v-center justify-content-between border-0 p-2 c-dark expand w-100">
                      <div class="v-center">
                        <i class="i-icon i-triangle-right expand-icon bg-dark opacity-6 mr-3" aria-hidden="true"
                          [class.expand]="topExpanded"></i>
                        <span class="f-6 font-weight-bold">Tracked last by</span>
                      </div>
                      <div class="v-center">
                        <i class="i-icon i-calendar bgc-blue ml-1" aria-hidden="true"></i>
                        <span class="ml-2 f-3 font-weight-bold c-blue text-uppercase">Total</span>
                      </div>
                    </div>
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="contacts-wrapper w-100">
                  <table class="table watched-contact-table p-2">
                    <thead>
                      <tr>
                        <th class="link name">No</th>
                        <th class="generate date">Generated Date</th>
                        <th class="track date">Tracked Date</th>
                        <th class="progress-wrapper" *ngIf="analytic_material.material_type!=='image'">Progress</th>
                        <th class="contact name">Contact</th>
                        <th class="link info"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngFor="let track of tracks;let i = index">
                        <tr [class.highlight]="highlightElement(track._id)" id={{track._id}}>
                          <td class="link name">
                            {{i+1}}
                          </td>
                          <td class="generate date">
                            {{track.created_at|date: 'MMM dd, hh:mm a'}}
                          </td>
                          <td class="track date">
                            <div>
                              {{track.updated_at|date: 'MMM dd, hh:mm a'}}
                            </div>
                          </td>
                          <td class="progress-wrapper">
                            <div *ngIf="track.video_trackers"
                              class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                              {{(track.video_trackers.duration / analytic_material.duration * 100).toFixed(1)}}%
                            </div>
                            <div *ngIf="!track.video_trackers"
                              class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                              0%
                            </div>
                          </td>
                          <td class="contact name d-flex" *ngIf="!track.contacts">

                          </td>
                          <td class="contact name d-flex" *ngIf="track.contacts" (click)="toContact(track.contacts._id)"
                            style="cursor: pointer;">
                            <div>
                              <img *ngIf="track.contacts.picture_profile; else avatarNameTemplate"
                                [src]="track.contacts.picture_profile"
                                onerror="( this.src = './assets/img/user_avatar.svg');"
                                class="form-avatar rounded-circle mr-1" />
                              <ng-template #avatarNameTemplate>
                                <div class="form-avatar rounded-circle bg-dark mr-3">
                                  {{getAvatarName(track.contacts)}}</div>
                              </ng-template>
                            </div>
                            <div class="f-4 ml-2">
                              <div *ngIf="!track.contacts.first_name && !track.contacts.last_name">Unnamed Contact
                              </div>
                              <div *ngIf="track.contacts.first_name || track.contacts.last_name">
                                {{track.contacts.first_name || ''}} {{track.contacts.last_name || ''}}
                              </div>
                            </div>
                          </td>
                          <td class="link info">
                            <div class="d-flex" *ngIf="!track.contacts">
                              <div class="d-flex" style="width:100px;justify-content: space-evenly;">
                                <div class="new contact">
                                  <button class="v-center btn p-1 c-dark" (click)="createContact(track)"
                                    placement="top-right" ngbTooltip="Create Contact">
                                    <i class="i-icon i-person bgc-dark" aria-hidden="true"></i>
                                  </button>
                                </div>
                                <div class="assign contact">
                                  <button class="v-center btn p-1 c-dark" (click)="assignContact(track)"
                                    placement="top-right" ngbTooltip="Assign Contact">
                                    <i class="i-icon i-person-add bgc-dark" aria-hidden="true"></i>
                                  </button>
                                </div>
                              </div>
                              <div>
                                <button class="v-center btn p-1 c-dark" (click)="copyTrackLink(track)"
                                  placement="top-right" ngbTooltip="Copy Link">
                                  <i class="i-icon i-copy bgc-dark" aria-hidden="true"></i>
                                </button>
                              </div>
                            </div>
                            <div class='d-flex' *ngIf="track.contacts">
                              <div style="width: 100px;">
                              </div>
                              <div>
                                <button class="v-center btn p-1 c-dark" (click)="copyTrackLink(track)"
                                  placement="top-right" ngbTooltip="Copy Link">
                                  <i class="i-icon i-copy bgc-dark" aria-hidden="true"></i>
                                </button>
                              </div>
                            </div>
                          </td>
                        </tr>
                      </ng-container>
                      <!-- <ng-container *ngIf="contacts">
                        <tr *ngFor="let contact of contacts">
                          <td class="link name">
                            <div class="v-center c-pointer" (click)="toContact(contact._id)">
                              <div>
                                <img *ngIf="contact.picture_profile; else avatarNameTemplate"
                                  [src]="contact.picture_profile"
                                  onerror="( this.src = './assets/img/user_avatar.svg');"
                                  class="form-avatar rounded-circle mr-1" />
                                <ng-template #avatarNameTemplate>
                                  <div class="form-avatar rounded-circle bg-dark mr-3">{{getAvatarName(contact)}}</div>
                                </ng-template>
                              </div>
                              <div class="f-4 ml-2">
                                <div *ngIf="!contact.first_name && !contact.last_name">Unnamed Contact</div>
                                <div *ngIf="contact.first_name || contact.last_name">
                                  {{contact.first_name || ''}} {{contact.last_name || ''}}
                                </div>
                              </div>
                            </div>
                          </td>
                          <td class="generate date">
                            <div class="v-center">
                              <div class="label-container">
                                <div class="label-rectangle"
                                  [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                                <div class="label-circle"
                                  [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                              </div>
                              <span class="f-3 font-weight-bold ml-2">{{getLabelById(contact.label).name}}</span>
                            </div>
                          </td>
                          <td class="track date">
                            <div class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                              {{(contact.duration / analytic_material.duration * 100).toFixed(1)}}%</div>
                          </td>
                          <td class="contact name">
                            {{contact.updated_at | date: 'MMM dd, hh:mm a'}}
                          </td>
                        </tr>
                      </ng-container> -->
                  </table>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </div>
        </div>
      </div>
      <ng-template #otheranalyticTemplate>
        <div class="analytics-area mt-3">
          <div class="material-wrapper form-group">
            <a href="{{siteUrl}}/pdf?pdf={{material_id}}&user={{user_id}}" target="_blank"
              *ngIf="analytic_material.material_type=='pdf'">
              <div class="thumb-prev-wrapper">
                <img [src]="analytic_material.preview" class="thumbnail"
                  onerror="( this.src = './assets/img/video_thumb.jpg');" />
                <img [src]="analytic_material.preview" class="preview"
                  onerror="( this.src = './assets/img/video_thumb.jpg');" />
              </div>
            </a>
            <a href="{{siteUrl}}/image?image={{material_id}}&user={{user_id}}" target="_blank"
              *ngIf="analytic_material.material_type=='image'">
              <div class="thumb-prev-wrapper">
                <img [src]="analytic_material.preview" class="thumbnail"
                  onerror="( this.src = './assets/img/video_thumb.jpg');" />
                <img [src]="analytic_material.preview" class="preview"
                  onerror="( this.src = './assets/img/video_thumb.jpg');" />
              </div>
            </a>
            <div class="mt-3">
              <label>Title</label>
              <div class="f-3 font-weight-bold">{{analytic_material.title}}</div>
            </div>
            <div class="mt-3">
              <label>Description</label>
              <div class="f-1">{{(analytic_material.description || '') | stripTags | shorten: 120: '...'}}</div>
            </div>
            <div class="mt-3">
              <label>Type</label>
              <div class="v-center f-3 font-weight-bold">
                <i class="i-icon d-block bgc-black" [class]="'i-' + getMaterialType().toLowerCase()"></i>
                <span class="f-3 font-weight-bold ml-3">{{getMaterialType()}}</span>
              </div>
            </div>
          </div>
          <div class="analytics-wrapper ml-lg-5 ml-md-3 ml-sm-0 ml-0 mt-md-0 mt-sm-0 mt-3">
            <!-- <div class="material-track p-4 mb-5">
            <div class="f-6 font-weight-bold mb-4">
              crmgrow allows you to track:
            </div>
            <div class="track-allow-selector">
              <div class="track-item">
                <img src="../../../assets/img/onboarding/track_allow_1.svg">
                <div class="f-4 mt-2">
                  Which contacts have watched your video.
                </div>
              </div>
              <div class="track-item">
                <img src="../../../assets/img/onboarding/track_allow_2.svg">
                <div class="f-4 mt-2">
                  When and how many times  they have watched it.
                </div>
              </div>
              <div class="track-item">
                <img src="../../../assets/img/onboarding/track_allow_3.svg">
                <div class="f-4 mt-2">
                  How much of the video they watched.
                </div>
              </div>
            </div>  
          </div> -->
            <div class="range-selector">
              <div class="range-item">
                <div class="v-center justify-content-between">
                  <div class="f-3 font-weight-bold c-dark">Sent</div>
                  <!-- <div class="v-center">
                  <i class="i-icon arrow-icon i-triangle-left bgc-dark"></i>
                  <div class="f-1 c-range select-text font-weight-bold text-uppercase c-dark">Total</div>
                  <i class="i-icon arrow-icon i-triangle-right bgc-dark"></i>
                </div> -->
                </div>
                <div class="mt-3">
                  <p class="f-40 c-blue">{{analytics.sent_activity}}</p>
                </div>
              </div>
              <div class="range-item">
                <div class="v-center justify-content-between">
                  <div class="f-3 font-weight-bold c-dark">Watched</div>
                  <!-- <div class="v-center">
                  <i class="i-icon arrow-icon i-triangle-left bgc-dark"></i>
                  <div class="f-1 c-range select-text font-weight-bold text-uppercase c-dark">Total</div>
                  <i class="i-icon arrow-icon i-triangle-right bgc-dark"></i>
                </div> -->
                </div>
                <div class="mt-3">
                  <p class="f-40 c-blue">{{analytics.watched_activity.length}}</p>
                </div>
              </div>
              <div class="range-item">
                <div class="v-center justify-content-between">
                  <div class="f-3 font-weight-bold c-dark">Unique contact</div>
                  <!-- <div class="v-center">
                  <i class="i-icon arrow-icon i-triangle-left bgc-dark"></i>
                  <div class="f-1 c-range select-text font-weight-bold text-uppercase c-dark">Total</div>
                  <i class="i-icon arrow-icon i-triangle-right bgc-dark"></i>
                </div> -->
                </div>
                <div class="mt-3">
                  <p class="f-40 c-blue">{{analytics.watched_contacts.length}}</p>
                </div>
              </div>
            </div>
            <div class="mt-3">
              <mat-accordion>
                <mat-expansion-panel [expanded]="topExpanded" hideToggle>
                  <mat-expansion-panel-header (click)="changeExpanded()">
                    <mat-panel-title>
                      <div class="v-center justify-content-between border-0 p-2 c-dark expand w-100">
                        <div class="v-center">
                          <i class="i-icon i-triangle-right expand-icon bg-dark opacity-6 mr-3" aria-hidden="true"
                            [class.expand]="topExpanded"></i>
                          <span class="f-6 font-weight-bold">Watched last by</span>
                        </div>
                        <div class="v-center">
                          <i class="i-icon i-calendar bgc-blue ml-1" aria-hidden="true"></i>
                          <span class="ml-2 f-3 font-weight-bold c-blue text-uppercase">Total</span>
                        </div>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="contacts-wrapper w-100">
                    <table class="table watched-contact-table p-2">
                      <thead>
                        <tr>
                          <th class="name">Contact Name</th>
                          <th class="label">Label</th>
                          <th class="progress-wrapper" *ngIf="analytic_material.material_type!=='image'">Progress</th>
                          <th class="watched-date">Watched Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <ng-container *ngIf="contacts">
                          <tr *ngFor="let contact of contacts">
                            <td class="name">
                              <div class="v-center c-pointer" (click)="toContact(contact._id)">
                                <div>
                                  <img *ngIf="contact.picture_profile; else avatarNameTemplate"
                                    [src]="contact.picture_profile"
                                    onerror="( this.src = './assets/img/user_avatar.svg');"
                                    class="form-avatar rounded-circle mr-1" />
                                  <ng-template #avatarNameTemplate>
                                    <div class="form-avatar rounded-circle bg-dark mr-3">{{getAvatarName(contact)}}
                                    </div>
                                  </ng-template>
                                </div>
                                <div class="f-4 ml-2">
                                  <div *ngIf="!contact.first_name && !contact.last_name">Unnamed Contact</div>
                                  <div *ngIf="contact.first_name || contact.last_name">
                                    {{contact.first_name || ''}} {{contact.last_name || ''}}
                                  </div>
                                </div>
                              </div>
                            </td>
                            <td class="label">
                              <div class="v-center">
                                <div class="label-container">
                                  <div class="label-rectangle"
                                    [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                                  <div class="label-circle"
                                    [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                                </div>
                                <span class="f-3 font-weight-bold ml-2">{{getLabelById(contact.label).name}}</span>
                              </div>
                            </td>
                            <td class="progress-wrapper" *ngIf="analytic_material.material_type!=='image'">
                              <div class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                                {{(contact.read_pages / (contact.total_pages+1) * 100).toFixed(1)}}%</div>
                            </td>
                            <td class="watched-date">
                              {{contact.updated_at | date: 'MMM dd, hh:mm a'}}
                            </td>
                          </tr>
                        </ng-container>
                    </table>
                  </div>
                </mat-expansion-panel>
              </mat-accordion>
            </div>
            <div class="mt-3">
              <mat-accordion>
                <mat-expansion-panel [expanded]="lowExpanded" hideToggle>
                  <mat-expansion-panel-header (click)="changeTrackExpanded()">
                    <mat-panel-title>
                      <div class="v-center justify-content-between border-0 p-2 c-dark expand w-100">
                        <div class="v-center">
                          <i class="i-icon i-triangle-right expand-icon bg-dark opacity-6 mr-3" aria-hidden="true"
                            [class.expand]="topExpanded"></i>
                          <span class="f-6 font-weight-bold">Tracked last by</span>
                        </div>
                        <div class="v-center">
                          <i class="i-icon i-calendar bgc-blue ml-1" aria-hidden="true"></i>
                          <span class="ml-2 f-3 font-weight-bold c-blue text-uppercase">Total</span>
                        </div>
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div class="contacts-wrapper w-100">
                    <table class="table watched-contact-table p-2">
                      <thead>
                        <tr>
                          <th class="link name">No</th>
                          <th class="generate date">Generated Date</th>
                          <th class="track date">Tracked Date</th>
                          <th class="progress-wrapper" *ngIf="analytic_material.material_type!=='image'">Progress</th>
                          <th class="contact name">Contact</th>
                          <th class="link info"></th>
                        </tr>
                      </thead>
                      <tbody>
                        <ng-container *ngFor="let track of tracks;let i = index">
                          <tr [class.highlight]="highlightElement(track._id)" id={{track._id}}>
                            <td class="link name">
                              {{i+1}}
                            </td>
                            <td class="generate date">
                              {{track.created_at|date: 'MMM dd, hh:mm a'}}
                            </td>
                            <td class="track date">
                              <div>
                                {{track.updated_at|date: 'MMM dd, hh:mm a'}}
                              </div>
                            </td>
                            <td class="progress-wrapper" *ngIf="analytic_material.material_type!=='image'">
                              <div *ngIf="track.pdf_trackers && track.pdf_trackers.read_pages"
                                class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                                {{(track.pdf_trackers.read_pages / (track.pdf_trackers.total_pages+1) *
                                100).toFixed(1)}}%
                              </div>
                              <div *ngIf="!track.pdf_trackers"
                                class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                                0%
                              </div>
                              <div *ngIf="track.pdf_trackers && !track.pdf_trackers.read_pages"
                                class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                                0%
                              </div>
                            </td>
                            <td class="contact name d-flex" *ngIf="!track.contacts">
                            </td>
                            <td class="contact name d-flex" *ngIf="track.contacts"
                              (click)="toContact(track.contacts._id)" style="cursor: pointer;">
                              <div>
                                <img *ngIf="track.contacts.picture_profile; else avatarNameTemplate"
                                  [src]="track.contacts.picture_profile"
                                  onerror="( this.src = './assets/img/user_avatar.svg');"
                                  class="form-avatar rounded-circle mr-1" />
                                <ng-template #avatarNameTemplate>
                                  <div class="form-avatar rounded-circle bg-dark mr-3">
                                    {{getAvatarName(track.contacts)}}</div>
                                </ng-template>
                              </div>
                              <div class="f-4 ml-2">
                                <div *ngIf="!track.contacts.first_name && !track.contacts.last_name">Unnamed Contact
                                </div>
                                <div *ngIf="track.contacts.first_name || track.contacts.last_name">
                                  {{track.contacts.first_name || ''}} {{track.contacts.last_name || ''}}
                                </div>
                              </div>
                            </td>
                            <td class="link info">
                              <div class="d-flex" *ngIf="!track.contacts">
                                <div class="d-flex" style="width:100px;justify-content: space-evenly;">
                                  <div class="new contact">
                                    <button class="v-center btn p-1 c-dark" (click)="createContact(track)"
                                      placement="top-right" ngbTooltip="Create Contact">
                                      <i class="i-icon i-person bgc-dark" aria-hidden="true"></i>
                                    </button>
                                  </div>
                                  <div class="assign contact">
                                    <button class="v-center btn p-1 c-dark" (click)="assignContact(track)"
                                      placement="top-right" ngbTooltip="Assign Contact">
                                      <i class="i-icon i-person-add bgc-dark" aria-hidden="true"></i>
                                    </button>
                                  </div>
                                </div>
                                <div>
                                  <button class="v-center btn p-1 c-dark" (click)="copyTrackLink(track)"
                                    placement="top-right" ngbTooltip="Copy Link">
                                    <i class="i-icon i-copy bgc-dark" aria-hidden="true"></i>
                                  </button>
                                </div>
                              </div>
                              <div class='d-flex' *ngIf="track.contacts">
                                <div style="width: 100px;">
                                </div>
                                <div>
                                  <button class="v-center btn p-1 c-dark" (click)="copyTrackLink(track)"
                                    placement="top-right" ngbTooltip="Copy Link">
                                    <i class="i-icon i-copy bgc-dark" aria-hidden="true"></i>
                                  </button>
                                </div>
                              </div>
                            </td>
                          </tr>
                        </ng-container>
                        <!-- <ng-container *ngIf="contacts">
                          <tr *ngFor="let contact of contacts">
                            <td class="link name">
                              <div class="v-center c-pointer" (click)="toContact(contact._id)">
                                <div>
                                  <img *ngIf="contact.picture_profile; else avatarNameTemplate"
                                    [src]="contact.picture_profile"
                                    onerror="( this.src = './assets/img/user_avatar.svg');"
                                    class="form-avatar rounded-circle mr-1" />
                                  <ng-template #avatarNameTemplate>
                                    <div class="form-avatar rounded-circle bg-dark mr-3">{{getAvatarName(contact)}}</div>
                                  </ng-template>
                                </div>
                                <div class="f-4 ml-2">
                                  <div *ngIf="!contact.first_name && !contact.last_name">Unnamed Contact</div>
                                  <div *ngIf="contact.first_name || contact.last_name">
                                    {{contact.first_name || ''}} {{contact.last_name || ''}}
                                  </div>
                                </div>
                              </div>
                            </td>
                            <td class="generate date">
                              <div class="v-center">
                                <div class="label-container">
                                  <div class="label-rectangle"
                                    [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                                  <div class="label-circle"
                                    [ngStyle]="{'background-color': getLabelById(contact.label).color}"></div>
                                </div>
                                <span class="f-3 font-weight-bold ml-2">{{getLabelById(contact.label).name}}</span>
                              </div>
                            </td>
                            <td class="track date">
                              <div class="progress-box f-3 font-weight-bold bgc-blue p-1 text-center c-white">
                                {{(contact.duration / analytic_material.duration * 100).toFixed(1)}}%</div>
                            </td>
                            <td class="contact name">
                              {{contact.updated_at | date: 'MMM dd, hh:mm a'}}
                            </td>
                          </tr>
                        </ng-container> -->
                    </table>
                  </div>
                </mat-expansion-panel>
              </mat-accordion>
            </div>
          </div>
        </div>
      </ng-template>

    </ng-container>
  </div>